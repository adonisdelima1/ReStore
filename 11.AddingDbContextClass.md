# Adding DbContext class 
## REMINDERS  
- The ``DbContext`` class provides us with a **gateway to our database** or provides us with **a session to our database**. It's going to be responsible for **opening** the connection and **managing** this connection to the database. 
- The ``DbContext`` can have more than one ``DbSet`` and these ``DbSet``s represent tables inside our database. A ``DbSet`` **is an equivalent to a table inside our database**. 

## Adding Entity Framework related nuget packages into the project 
1. Ctrl + Shift + P to show all commands 
2. Search for **NuGet** by typing it on the text field 
3. Open NuGet gallery (by clicking/choosing **Focus on NuGet view** option) 
4. On NuGet view, search for "**Microsoft.EntityFrameworkCore.Sqlite**" and add it to the API project 
5. Still on NuGet view, search for "**Microsoft.EntityFrameworkCore.Design**" and add it as well 
6. Check our success inside API.csproj file. There must be references about the new packages. To use them in the code, you need to mention them on the usings area of a DbContext class  
7. At the same level of Controllers and Entities folders create a one a new one called **Data** and inside it create a new class called ``StoreContext`` that will derive (inherit) from **DbContext** type (from MS EF Core, don't forget it on usings). Don't forget to include all the Entities/Tables/DbSets of the project (at this point there might be just Product). Choose the constructor that is prepared to receive options as arguments (because we need to pass the connection string trough DI on Startup/Program class when adding services). This class should be similar to this: 

    ```C#
    using API.Entities;
    using Microsoft.EntityFrameworkCore;

    namespace API.Data
    {
        public class StoreContext : DbContext
        {
            public StoreContext(DbContextOptions options) : base(options)
            {

            }
            
            public DbSet<Product> Products { get; set; }
        }
    }
    ```


8. On Startup or Program class (you've gotta find it) add a new service of DBContext declaring StoreContext as the type and, inside argument area declare the parameter and it start Lambda expression function and use this parameter to call ``UseSqlite()`` method and inside parameter use Configuration (appsettings instance) to keep your connection string named as DefaultConnection. DbContext injection on **Program.cs** should be similar to this: 
    ```C#  
    
    builder.Services.AddDbContext<StoreContext>(opt => 
    {  
      opt.UseSqlite(builder.Configuration.GetConnectionString("DefaultConnection"));  
    });
    ```

**Continues on [12.CreatingAnEntityFrameworkMigration](./12.CreatingAnEntityFrameworkMigration.md)**

  